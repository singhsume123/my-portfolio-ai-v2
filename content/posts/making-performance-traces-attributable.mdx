---
title: "Making Performance Traces Attributable"
date: "2025-12-25"
slug: "making-performance-traces-attributable"
tags: ["Android", "Performance", "Perfetto", "Mobile", "Observability"]
substackUrl: "https://sumeetarora.substack.com/p/making-performance-traces-attributable"
---

# Making Performance Traces Attributable üß≠

![Android app performance](https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fba5a28ae-ecc4-420d-b114-19700e04529b_1024x608.png)

This is **Part 2** of a series on mobile app performance analysis.

Part 1 focused on making Perfetto traces human-readable by extracting key metrics like startup time, long tasks, and frame health.

Part 2 builds on that foundation by adding **attribution**: identifying *who* performed the work in a trace.

## The Problem ‚öôÔ∏è

Part 1 could identify *what* happened in traces but couldn't answer critical questions:
- Which process performed the work?
- Was it running on the main thread?
- Is this app code or system work?

The new analyzer addresses these attribution challenges.

## Key Solutions

**Main Thread Detection**
Since traces don't always explicitly label the main thread, the analyzer uses heuristics: checking for a thread named "main" first, then falling back to `tid == pid` for Android processes.

**Focus Process Capability**
Users can now specify a focus process to filter noise:
```bash
python -m perfetto_agent.cli analyze \
  --trace tracetoy_trace.perfetto-trace \
  --focus-process com.example.tracetoy
```

**Attribution Details**
Long tasks now include process name, thread name, PID, and TID, enabling immediate identification of responsibility.

**App-Defined Sections**
The analyzer extracts sections created via `Trace.beginSection`, ranking them by total execution time to highlight dominant app operations.

**Summary Block**
A new summary section surfaces top app sections and key findings upfront for quick orientation.

## Next Steps (Part 3)

Future work will focus on separating app versus framework versus system work, tightening rendering attribution, and identifying signals that matter for performance explanations.
